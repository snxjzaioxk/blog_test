# è¡¨æƒ…åŒ…ä¸­è½¬ç«™-åˆæ­¥æ–¹æ¡ˆ

ä¸‹é¢æ˜¯ä¸€ä¸ª**æœ¬åœ°è¡¨æƒ…åŒ…ä¸­è½¬ç«™**çš„è®¾è®¡æ–¹æ¡ˆï¼Œå®Œå…¨è¿è¡Œåœ¨ç”¨æˆ·è®¾å¤‡ä¸Šï¼Œæ— éœ€è”ç½‘ï¼Œå®ç°è¡¨æƒ…åŒ…çš„åˆ†ç±»å­˜å‚¨ã€è®¡æ•°ç®¡ç†å’Œå¿«é€Ÿä¸­è½¬åŠŸèƒ½ï¼š

------

### **ç³»ç»Ÿæ¶æ„**

å›¾è¡¨

ä»£ç 



------

### **æ ¸å¿ƒåŠŸèƒ½å®ç°**

#### 1. **æ–‡ä»¶å­˜å‚¨ç»“æ„**

text

```
ğŸ“ EmoticonHub/
â”œâ”€â”€ ğŸ“ Categories/          # åˆ†ç±»æ–‡ä»¶å¤¹
â”‚   â”œâ”€â”€ ğŸ“ æ²™é›•æ—¥å¸¸/        # ç”¨æˆ·è‡ªå®šä¹‰åˆ†ç±»
â”‚   â”œâ”€â”€ ğŸ“ çŒ«çŒ«åˆé›†/
â”‚   â””â”€â”€ ...
â”œâ”€â”€ ğŸ“„ emoticon.db         # SQLiteæ•°æ®åº“
â””â”€â”€ ğŸ“„ hub.exe             # ç®¡ç†ç¨‹åº
```

#### 2. **æ•°æ®åº“è®¾è®¡ï¼ˆSQLiteï¼‰**

sql

```
-- è¡¨æƒ…åŒ…è®°å½•è¡¨
CREATE TABLE emoticons (
    id INTEGER PRIMARY KEY,
    file_name TEXT NOT NULL,      -- æ–‡ä»¶åï¼šcat_meme_01.webp
    category TEXT DEFAULT 'æœªåˆ†ç±»', -- æ‰€å±åˆ†ç±»
    add_count INTEGER DEFAULT 1,   -- æ·»åŠ æ¬¡æ•°
    use_count INTEGER DEFAULT 0,   -- ä½¿ç”¨æ¬¡æ•°
    last_used TIMESTAMP,           -- æœ€åä½¿ç”¨æ—¶é—´
    file_hash TEXT UNIQUE          -- æ–‡ä»¶å“ˆå¸Œå€¼ï¼ˆé˜²é‡å¤ï¼‰
);

-- åˆ†ç±»ç»Ÿè®¡è¡¨
CREATE TABLE categories (
    name TEXT PRIMARY KEY,
    emoticon_count INTEGER DEFAULT 0,
    total_use INTEGER DEFAULT 0
);
```

------

### **æ“ä½œæµç¨‹**

å›¾è¡¨

ä»£ç 

æ¸²æŸ“å¤±è´¥

------

### **å…³é”®æŠ€æœ¯å®ç°**

#### 1. **è¡¨æƒ…åŒ…ç®¡ç†**

python

```
# Pythonç¤ºä¾‹ï¼ˆä½¿ç”¨PyQt+SQLiteï¼‰
def add_emoticon(file_path, category):
    # è®¡ç®—æ–‡ä»¶å“ˆå¸Œï¼ˆSHA256ï¼‰
    file_hash = hashlib.sha256(open(file_path,'rb').read()).hexdigest()
    
    # æ£€æŸ¥é‡å¤
    if db.query("SELECT id FROM emoticons WHERE file_hash=?", file_hash):
        db.execute("UPDATE emoticons SET add_count=add_count+1 WHERE file_hash=?", file_hash)
        return "é‡å¤æ·»åŠ "

    # å­˜å‚¨æ–‡ä»¶
    new_name = f"{category}_{int(time.time())}.{file_path.split('.')[-1]}"
    shutil.copy(file_path, f"Categories/{category}/{new_name}")
    
    # æ•°æ®åº“è®°å½•
    db.execute("""
        INSERT INTO emoticons 
        (file_name, category, file_hash) 
        VALUES (?,?,?)
    """, (new_name, category, file_hash))
```

#### 2. **ä½¿ç”¨ç»Ÿè®¡**

python

```
def use_emoticon(emoticon_id, target_app):
    # è·å–æ–‡ä»¶è·¯å¾„
    file_name, category = db.query("SELECT file_name,category FROM emoticons WHERE id=?", emoticon_id)
    src_path = f"Categories/{category}/{file_name}"
    
    # å¤åˆ¶åˆ°ç›®æ ‡åº”ç”¨
    if target_app == "å¾®ä¿¡":
        dest_path = "~/Documents/WeChat Files/Emotions/"
    elif target_app == "QQ":
        dest_path = "~/Library/Containers/com.tencent.qq/Data/Documents/qqsticker/"
    
    shutil.copy(src_path, dest_path)
    
    # æ›´æ–°è®¡æ•°
    db.execute("UPDATE emoticons SET use_count=use_count+1, last_used=CURRENT_TIMESTAMP WHERE id=?", emoticon_id)
    db.execute("UPDATE categories SET total_use=total_use+1 WHERE name=?", category)
```

------

### **ç®¡ç†ç•Œé¢åŠŸèƒ½**

å›¾è¡¨

ä»£ç 

æ¸²æŸ“å¤±è´¥

1. **å·¦ä¾§åˆ†ç±»æ ‘**
   - æ˜¾ç¤ºæ‰€æœ‰åˆ†ç±»åŠè¡¨æƒ…æ•°é‡
   - å³é”®èœå•ï¼šæ–°å»º/é‡å‘½å/åˆ é™¤åˆ†ç±»
2. **ä¸­å¤®ç¼©ç•¥å›¾åŒº**
   - ç½‘æ ¼å±•ç¤ºè¡¨æƒ…åŒ…é¢„è§ˆå›¾
   - æ‚¬åœæ˜¾ç¤ºä½¿ç”¨æ¬¡æ•°ï¼š`ä½¿ç”¨ 27æ¬¡`
   - æ‹–æ‹½åˆ°å¤–éƒ¨åº”ç”¨è‡ªåŠ¨å‘é€
3. **åº•éƒ¨çŠ¶æ€æ **
   - æ€»å­˜å‚¨é‡ï¼š`1.2GB/358ä¸ªæ–‡ä»¶`
   - ä»Šæ—¥ä½¿ç”¨ï¼š`å·²ä½¿ç”¨ 12 æ¬¡`
   - çƒ­é—¨åˆ†ç±»ï¼š`çŒ«çŒ«åˆé›† (ä½¿ç”¨ 89 æ¬¡)`

------

### **æŠ€æœ¯äº®ç‚¹**

1. **é‡å¤æ–‡ä»¶æ£€æµ‹**

   - é€šè¿‡SHA256å“ˆå¸Œå€¼è¯†åˆ«é‡å¤å†…å®¹
   - é‡å¤æ·»åŠ æ—¶è‡ªåŠ¨å¢åŠ `add_count`è®¡æ•°

2. **è·¨å¹³å°æ”¯æŒ**

   - æ–‡ä»¶è·¯å¾„è‡ªåŠ¨é€‚é…ï¼š

     python

     ```
     if sys.platform == "win32":
         return "C:/Users/{user}/AppData/Local"
     elif sys.platform == "darwin":
         return "/Users/{user}/Library/Application Support"
     ```

3. **ä½èµ„æºå ç”¨**

   - SQLiteæ•°æ®åº“é€šå¸¸ < 1MB
   - å†…å­˜å ç”¨ < 50MB

4. **å¿«é€Ÿæ£€ç´¢**

   sql

   ```
   -- æŸ¥æ‰¾ä½¿ç”¨è¶…è¿‡10æ¬¡çš„çŒ«çŒ«è¡¨æƒ…
   SELECT * FROM emoticons 
   WHERE category='çŒ«çŒ«åˆé›†' AND use_count > 10
   ORDER BY last_used DESC;
   ```

------

### **éƒ¨ç½²æ–¹å¼**

1. ä¸‹è½½å•æ–‡ä»¶æ‰§è¡ŒåŒ…ï¼ˆWindows/macOSï¼‰
2. è§£å‹åˆ°ä»»æ„ç›®å½•
3. é¦–æ¬¡è¿è¡Œæ—¶è‡ªåŠ¨åˆ›å»ºï¼š
   - `EmoticonHub`ä¸»ç›®å½•
   - é»˜è®¤åˆ†ç±»æ–‡ä»¶å¤¹
   - åˆå§‹æ•°æ®åº“

> **æ³¨æ„äº‹é¡¹**ï¼š
>
> - æ”¯æŒå¸¸è§å›¾ç‰‡æ ¼å¼ï¼šPNG/JPG/WEBP/GIF
> - å•ä¸ªæ–‡ä»¶å»ºè®® < 10MB
> - å®šæœŸå¤‡ä»½`EmoticonHub`æ–‡ä»¶å¤¹é˜²æ­¢æ•°æ®ä¸¢å¤±

æ­¤æ–¹æ¡ˆæ— éœ€ç½‘ç»œè¿æ¥ï¼Œæ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨æœ¬åœ°ï¼Œé€šè¿‡æ–‡ä»¶ç³»ç»Ÿ+è½»é‡æ•°æ®åº“å®ç°è¡¨æƒ…åŒ…çš„åˆ†ç±»å­˜å‚¨ã€ä½¿ç”¨ç»Ÿè®¡å’Œå¿«é€Ÿä¸­è½¬ï¼Œå®Œç¾æ»¡è¶³æ‚¨çš„éœ€æ±‚ã€‚